## Additional Utilities and Commands

- Run full end-to-end pipeline and generate reports and PPTX:

```powershell
python end_to_end.py
```

- Run and open outputs (HTML, diffs, tree-diffs, PPTX):

```powershell
python run_and_open.py
```

- Commit generated outputs to git (use with care):

```powershell
python git_commit_outputs.py
```

## Generated Deliverables

After running the end-to-end pipeline or the dedicated generators, the following files are created in the project root or `out/`:

- `REPORT.docx` — full technical report (generated by `create_report_docx.py`).
- `FINAL_PRESENTATION.pptx` — full presentation (generated by `create_presentation_pptx.py`).
- `out/presentation_slide.pptx` — one-page summary slide (generated by `end_to_end.py`).

To regenerate both the DOCX and PPTX from source, run:

```powershell
python create_report_docx.py
python create_presentation_pptx.py
```


## Verification Results
...
# Agentic AI HTML5 Parser Pipeline

[![CI](https://github.com/Silvio777-hub/Agentic-HTML5-Parser/actions/workflows/ci.yml/badge.svg)](https://github.com/Silvio777-hub/Agentic-HTML5-Parser/actions)

## Project Overview
This project implements a subset of an HTML5 parser (specifically for `div` and `p` tags) using a multi-agent AI pipeline. Designed for the University of Florence (Topic 6), the system ensures high-fidelity parsing, automated compliance auditing, and hardware-level security isolation.

The pipeline transitions from a high-level specification to verified code through a series of discrete artifact-driven stages, ensuring reproducibility and a clear audit trail.

## Version 1.3.0 - Professional Suite
The current version (v1.3.0) introduces production-grade enhancements:

1. **Selector Agent (Query Engine)**: A programmatic utility that allows searching the DOM tree by ID or tag name.
2. **Semantic Compliance Auditor**: Beyond trace validation, this agent enforces HTML5 content model rules (e.g., preventing invalid nesting like `div` inside `p`).
3. **Full Attribute Parsing**: Supports complex HTML attributes, handles single-quotes, double-quotes, unquoted values, and boolean flags.
4. **Subprocess Sandboxing**: Utilizes Python's `multiprocessing` to isolate the parsing logic for hardware-level security.
5. **Structural Integrity Wrapper**: A post-parse verification layer that enforces DOM depth limits and maximum token counts.

## Project Structure
```
Agentic AI HTML5 Parser/
├── src/                        # Core source code
│   ├── parser.py               # HTML5 FSM parser (11 states)
│   ├── verifiers.py            # Differential tester, compliance auditor, selector agent, fuzzer
│   ├── robustness.py           # Sandbox and security wrapper
│   ├── preprocessor.py         # User text → IR converter
│   └── generator.py            # IR → HTML5 renderer
├── pipeline/
│   └── orchestrator.py         # Multi-agent pipeline simulation
├── tests/
│   ├── test_suite.py           # Main test suite (38 tests)
│   └── test_html_generation.py # Preprocessor/generator tests (3 tests)
├── prompts/                    # LLM prompt templates for each agent
├── demos/                      # 5 demo input files
├── out/                        # Generated HTML output from demos
├── runs/                       # Pipeline run artifacts
├── spec/                       # Seed specification
├── reproduce_bug/              # Repair story demo
├── docs/                       # Documentation and deliverables
├── cli.py                      # CLI for text → HTML conversion
├── run_all.py                  # Full pipeline execution script
├── generate_report.py          # Generates interactive HTML dashboard
├── create_report_docx.py       # Generates REPORT.docx
├── create_presentation_pptx.py # Generates FINAL_PRESENTATION.pptx
├── test_llm_connection.py      # LLM API connectivity checker
├── requirements.txt            # Python dependencies
├── .env.example                # Template for LLM API key config
└── README.md                   # This file
```

---

## Step-by-Step Guide to Running the Application

### Prerequisites
- **Python 3.10+** installed on your system (check with `python --version`).
- **pip** (comes with Python; check with `pip --version`).
- A **terminal / command prompt** open at the project root folder.

---

### Step 1: Open a Terminal in the Project Folder

Navigate to the project directory:
```bash
cd "path/to/Agentic AI HTML5 Parser"
```

---

### Step 2: Create a Virtual Environment (Recommended)

Creating a virtual environment keeps your dependencies isolated:
```bash
# Create the virtual environment
python -m venv .venv

# Activate it:
#   On Windows (PowerShell):
.venv\Scripts\Activate.ps1

#   On Windows (CMD):
.venv\Scripts\activate.bat

#   On macOS / Linux:
source .venv/bin/activate
```
> You should see `(.venv)` in your terminal prompt when activated.

---

### Step 3: Install Dependencies

```bash
pip install -r requirements.txt
```
This installs: `beautifulsoup4`, `pytest`, `python-docx`, `python-pptx`, `PyYAML`, `langchain`, `langgraph`, `pydantic`, `openai`, and `python-dotenv`.

---

### Step 4: Run the Full Test Suite

Verify everything works by running all tests:
```bash
python -m pytest tests/ -v
```
**Expected result**: `41 passed` — covering tokenizer states, DOM construction, implicit rules, attribute parsing, robustness/security, differential testing, fuzzing, selector agent, and semantic compliance.

---

### Step 5: Run the Interactive HTML Report

This generates the main project deliverable — a live dashboard at `report.html`:
```bash
python generate_report.py
```
Then **open `report.html` in your web browser** to see:
- Pipeline status cards
- Differential oracle results
- Compliance audit score
- Security fuzzer results
- Spec coverage chart with state pills
- Selector agent query results
- Token stream, DOM tree, and execution trace in JSON

---

### Step 6: Run the CLI Demo Conversions

Convert the demo text files into HTML pages:
```bash
python cli.py demos/demo1_simple_paragraph.txt out/demo1.html
python cli.py demos/demo2_links_and_attributes.txt out/demo2.html
python cli.py demos/demo3_nested_structure.txt out/demo3.html
python cli.py demos/demo4_form.txt out/demo4.html
python cli.py demos/demo5_malformed_input.txt out/demo5.html
```
Each command reads a demo input, processes it through the **Preprocessor → IR → Generator** pipeline, and writes a complete HTML file to `out/`.

Open any of the output files (e.g., `out/demo1.html`) in your browser to inspect the result.

---

### Step 7: Run the Full Pipeline Simulation

Executes the multi-agent pipeline, differential testing, fuzzing, and coverage analytics in one go:
```bash
python run_all.py
```
This creates artifacts inside `runs/perfect_final/` (spec, patches, reports, logs).

---

### Step 8: Run the Repair Story Demo

Demonstrates how the RepairAgent detects and diagnoses parser failures:
```bash
python reproduce_bug/run_repair_demo.py
```
This simulates a contradictory spec scenario and shows the diagnostic prompt that would be sent to an LLM for repair.

---

### Step 9: Generate Professional Deliverables

Generate the DOCX report and PPTX presentation:
```bash
python create_report_docx.py
python create_presentation_pptx.py
```
These create `REPORT.docx` and `FINAL_PRESENTATION.pptx` in the project root.

---

### Step 10 (Optional): Test LLM Connectivity

If you plan to connect the pipeline to a live LLM:

1. Copy `.env.example` to `.env`:
   ```bash
   copy .env.example .env
   ```
2. Edit `.env` and add your OpenAI API key.
3. Run the connectivity check:
   ```bash
   python test_llm_connection.py
   ```

> **Note**: The pipeline works fully offline using simulation mode. The LLM connection is only needed if you want to use real AI-generated patches.

---

## Verification Results
- **Unit Tests**: 41/41 Passed.
- **Spec Coverage**: 100% of defined FSM states (11 states).
- **Oracle Match**: 100% parity with BeautifulSoup4 (including attributes).
- **Security**: Passed all DoS and stack-overflow stress tests via sandbox.

## Professional Deliverables
Automated tools are included to generate formal documentation:
- `REPORT.docx`: Full technical report (Run `python create_report_docx.py`).
- `FINAL_PRESENTATION.pptx`: Presentation slides (Run `python create_presentation_pptx.py`).

## Authors
- John Silvio
- Umair Anwar
